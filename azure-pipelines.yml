trigger:
  branches:
    include: [main]

pr:
  branches:
    include: [main]

pool:
  vmImage: "ubuntu-latest"

steps:
  - task: UseUv@0
  - script: uv sync
    displayName: "Install dependencies"
  - script: uv run ruff check .
    displayName: "Lint"
  - script: uv run ruff format --check .
    displayName: "Format check"
  - script: uv run mypy src/
    displayName: "Type check"
  - script: uv run pytest --cov --cov-report=xml --cov-report=term
    displayName: "Test + coverage"
